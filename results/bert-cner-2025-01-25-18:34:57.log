Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
Training/evaluation parameters Namespace(task_name='cner', data_dir='/content/BERT-CRF-EVAL/datasets/cner/', model_type='bert', model_name_or_path='/content/BERT-CRF-EVAL/bert-base-chinese', output_dir='/content/BERT-CRF-EVAL/outputs/cner_output/bert', markup='bios', loss_type='ce', config_name='', tokenizer_name='', cache_dir='', train_max_seq_length=128, eval_max_seq_length=512, do_train=True, do_eval=True, do_predict=False, evaluate_during_training=False, do_lower_case=True, do_adv=False, adv_epsilon=1.0, adv_name='word_embeddings', per_gpu_train_batch_size=128, per_gpu_eval_batch_size=128, gradient_accumulation_steps=1, learning_rate=3e-05, crf_learning_rate=0.001, weight_decay=0.01, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=4.0, max_steps=-1, warmup_proportion=0.1, logging_steps=-1, save_steps=-1, eval_all_checkpoints=False, predict_checkpoints=0, no_cuda=False, overwrite_output_dir=True, overwrite_cache=False, seed=42, fp16=False, fp16_opt_level='O1', local_rank=-1, server_ip='', server_port='', n_gpu=1, device=device(type='cuda'), id2label={0: 'B-HCCX', 1: 'B-HPPX', 2: 'B-MISC', 3: 'B-XH', 4: 'I-HCCX', 5: 'I-HPPX', 6: 'I-MISC', 7: 'I-XH', 8: 'O'}, label2id={'B-HCCX': 0, 'B-HPPX': 1, 'B-MISC': 2, 'B-XH': 3, 'I-HCCX': 4, 'I-HPPX': 5, 'I-MISC': 6, 'I-XH': 7, 'O': 8})
Loading features from cached file /content/BERT-CRF-EVAL/datasets/cner/cached_crf-train_bert-base-chinese_128_cner
***** Running training *****
  Num examples = 5999
  Num Epochs = 4
  Instantaneous batch size per GPU = 128
  Total train batch size (w. parallel, distributed & accumulation) = 128
  Gradient Accumulation steps = 1
  Total optimization steps = 188
Loading features from cached file /content/BERT-CRF-EVAL/datasets/cner/cached_crf-dev_bert-base-chinese_512_cner
***** Running evaluation  *****
  Num examples = 997
  Batch size = 128


***** Eval results  *****
 acc: 0.7819 - recall: 0.7425 - f1: 0.7617 - loss: 12.9145 
***** Entity results  *****
******* HCCX results ********
 acc: 0.8157 - recall: 0.7945 - f1: 0.8050 
******* HPPX results ********
 acc: 0.6774 - recall: 0.6983 - f1: 0.6877 
******* MISC results ********
 acc: 0.7375 - recall: 0.6206 - f1: 0.6740 
******* XH results ********
 acc: 0.6321 - recall: 0.5019 - f1: 0.5595 
Saving model checkpoint to /content/BERT-CRF-EVAL/outputs/cner_output/bert/checkpoint-47
Saving optimizer and scheduler states to /content/BERT-CRF-EVAL/outputs/cner_output/bert/checkpoint-47


Loading features from cached file /content/BERT-CRF-EVAL/datasets/cner/cached_crf-dev_bert-base-chinese_512_cner
***** Running evaluation  *****
  Num examples = 997
  Batch size = 128


***** Eval results  *****
 acc: 0.8087 - recall: 0.8124 - f1: 0.8105 - loss: 10.2192 
***** Entity results  *****
******* HCCX results ********
 acc: 0.8356 - recall: 0.8324 - f1: 0.8340 
******* HPPX results ********
 acc: 0.7172 - recall: 0.7913 - f1: 0.7525 
******* MISC results ********
 acc: 0.7729 - recall: 0.7656 - f1: 0.7692 
******* XH results ********
 acc: 0.7490 - recall: 0.7266 - f1: 0.7376 
Saving model checkpoint to /content/BERT-CRF-EVAL/outputs/cner_output/bert/checkpoint-94
Saving optimizer and scheduler states to /content/BERT-CRF-EVAL/outputs/cner_output/bert/checkpoint-94


Loading features from cached file /content/BERT-CRF-EVAL/datasets/cner/cached_crf-dev_bert-base-chinese_512_cner
***** Running evaluation  *****
  Num examples = 997
  Batch size = 128


***** Eval results  *****
 acc: 0.8167 - recall: 0.8261 - f1: 0.8214 - loss: 9.4418 
***** Entity results  *****
******* HCCX results ********
 acc: 0.8407 - recall: 0.8457 - f1: 0.8432 
******* HPPX results ********
 acc: 0.7764 - recall: 0.7748 - f1: 0.7756 
******* MISC results ********
 acc: 0.7708 - recall: 0.8022 - f1: 0.7862 
******* XH results ********
 acc: 0.7190 - recall: 0.7378 - f1: 0.7283 
Saving model checkpoint to /content/BERT-CRF-EVAL/outputs/cner_output/bert/checkpoint-141
Saving optimizer and scheduler states to /content/BERT-CRF-EVAL/outputs/cner_output/bert/checkpoint-141


Loading features from cached file /content/BERT-CRF-EVAL/datasets/cner/cached_crf-dev_bert-base-chinese_512_cner
***** Running evaluation  *****
  Num examples = 997
  Batch size = 128


***** Eval results  *****
 acc: 0.8217 - recall: 0.8309 - f1: 0.8263 - loss: 9.0238 
***** Entity results  *****
******* HCCX results ********
 acc: 0.8427 - recall: 0.8516 - f1: 0.8471 
******* HPPX results ********
 acc: 0.7677 - recall: 0.7851 - f1: 0.7763 
******* MISC results ********
 acc: 0.7933 - recall: 0.8008 - f1: 0.7970 
******* XH results ********
 acc: 0.7341 - recall: 0.7341 - f1: 0.7341 
Saving model checkpoint to /content/BERT-CRF-EVAL/outputs/cner_output/bert/checkpoint-188
Saving optimizer and scheduler states to /content/BERT-CRF-EVAL/outputs/cner_output/bert/checkpoint-188


 global_step = 188, average loss = 15.209530860819715
Saving model checkpoint to /content/BERT-CRF-EVAL/outputs/cner_output/bert
Evaluate the following checkpoints: ['/content/BERT-CRF-EVAL/outputs/cner_output/bert']
Loading features from cached file /content/BERT-CRF-EVAL/datasets/cner/cached_crf-dev_bert-base-chinese_512_cner
***** Running evaluation  *****
  Num examples = 997
  Batch size = 128


***** Eval results  *****
 acc: 0.8217 - recall: 0.8309 - f1: 0.8263 - loss: 9.0238 
***** Entity results  *****
******* HCCX results ********
 acc: 0.8427 - recall: 0.8516 - f1: 0.8471 
******* HPPX results ********
 acc: 0.7677 - recall: 0.7851 - f1: 0.7763 
******* MISC results ********
 acc: 0.7933 - recall: 0.8008 - f1: 0.7970 
******* XH results ********
 acc: 0.7341 - recall: 0.7341 - f1: 0.7341 
